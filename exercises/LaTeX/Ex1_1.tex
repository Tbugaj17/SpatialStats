\documentclass{article}
\usepackage{amsmath, amssymb} % For advanced math formatting

\title{Spatial Statistics Exercises Lecture 1}
\author{Tanja Bugajski}
\date{\today}

\begin{document}

\maketitle

\section*{Exercise 2}
Consider a binomial process on a Borel set $S\subseteq \mathbb{R}^d$ with $n$ points, where
each point follows a pdf $f$. \\
\(a\) Show that the intensity measure is given by
\[
\mu(B)=n\int_B f(x) \text{d}x
\]
\subsection*{(a) Intensity Measure $\mu(B)$}

The intensity measure $\mu(B)$ of a point process represents the expected number of points in a Borel set $B \subseteq S$:

\[
    \mu(B) = \mathbb{E}[N(B)],
\]

where $N(B)$ is the number of points in $B$.

\paragraph{Step 1: Probability of a Single Point Being in $B$}
Each point in the binomial process is independently drawn from $S$ with pdf $f(x)$. The probability that a single point $X_i$ falls inside $B$ is:

\[
    P(X_i \in B) = \int_B f(x) dx.
\]

\paragraph{Step 2: Expected Number of Points in $B$}
Since the binomial process consists of $n$ independent points, the number of points in $B$ follows a binomial distribution:

\[
    N(B) \sim \text{Bin}(n, p), \quad \text{where } p = \int_B f(x) dx.
\]

The expectation of a binomial random variable is:

\[
    \mathbb{E}[N(B)] = n p = n \int_B f(x) dx.
\]
Thus, the intensity measure is:
\[
    \mu(B) = n \int_B f(x) dx.
\]

\(b\)  Show that the void probability is given by
\[
v(B)=\left( 1-\int_B f(x) \text{d}x \right)^n
\]
for any bounded Borel set $S\subseteq \mathbb{R}^d$.
\subsection*{(b) Void Probability $v(B)$}

The void probability $v(B)$ is the probability that no points fall inside the Borel set $B$:

\[
    v(B) = P(N(B) = 0).
\]

\paragraph{Step 1: Using the Binomial Distribution}
Since $N(B) \sim \text{Bin}(n, p)$, the probability of observing zero points in $B$ is given by the binomial probability mass function:

\[
    P(N(B) = 0) = \binom{n}{0} p^0 (1 - p)^n = (1 - p)^n.
\]

Substituting $p = \int_B f(x) dx$, we obtain:

\[
    v(B) = \left( 1 - \int_B f(x) dx \right)^n.
\]
\section*{3. Why is it impossible for the binomial process to be stationary?}
A process is stationary if its statistical properties remain the same when shifted spatially. 
For example, if you move the entire point pattern a certain distance in any direction, 
the distribution of points should look the same.

However, in a binomial process, the points are defined over a fixed and finite region. 
Thus, if we shift the region, points may move outside the original boundary, altering the statistical properties of the process. 
Which is the reason why the binomial process is not stationary.
\section*{4. Which of the following examples lead to the binomial process being isotropic:}
A function $f(x)$ is isotropic if for every orthogonal matrix $R \in O(d)$, where $R^T R=I$. We then have:
\[ 
f(Rx)=f(x), \quad \forall\  x\in \mathrm{R}^d.
\]
This means the function must be invariant under rotations.
\begin{enumerate}
    \item[(a)] $f(x) = \frac{1}{|B(0, 1)|}$, where $S = B(0, 1)$ is a unit ball in $\mathbb{R}^d$ with the center at the origin and $|B(0, 1)| = \int_{B(0,1)} du$. 
    
    \item[(b)] $f(x) = a^{-d}$ and $S$ is a $d$-dimensional box centered at the origin with side lengths $a > 0$.
    
    \item[(c)] $f(x)$ is the density of a $d$-dimensional normal distribution with mean vector 0 and covariance matrix $\sigma^2 I$, where $I$ is the identity matrix and $\sigma > 0$, and where $S = \mathbb{R}^d$.
\end{enumerate}
\(a\) Since a ball is symmetric under rotation and $f(x)$ is uniform inside it, this function is isotropic.\\
\(b\) The shape of the box breaks rotational symmetry. Thus, the function is not isotropic.\\
\(c\) The function $f(x)$ is the normal distribution. It is rotationally invariant, i.e, the function is isotropic.
\section*{5. A small exercise in measures:}
\begin{enumerate}
    \item[(a)] Show that the intensity measure given by
    \[
    \mu(B) = \int_B \rho(x) \, dx
    \]
    for a non-negative function $\rho$ and $B \in \mathcal{B}$ is indeed a measure (more precisely, $\rho$ needs to be a so-called Borel function, which means that $\rho^{-1}(I)$ is a Borel set for any bounded interval $I$, but we donâ€™t care about such measure theoretical details in this course).
    
    \item[(b)] On the other hand, argue why the void probability $v(B)$ for $B \in \mathcal{B}_0$ is not a measure on $S$. For instance, give a counter-example (hint: consider a binomial process).
\end{enumerate}
\(a\) To show that $\mu(B)$ is a measure it needs to verify three conditions:\\
1. Non-negativity: A measure must be non-negative for all measurable sets $\mathrm{B}$.\\
Since $\rho(x)<0$ for all $x$, then
\[ 
    \mu(B) = \int_B \rho(x) \, dx \geq 0,
\]
Since integration preserves non-negativity.\\
2. Null Empty Set: A measure must assign measure zero to the empty set, thus\\
\[ 
    \mu(\emptyset) = \int_{\emptyset} \rho(x) \, dx=0.
\]
Since integration over the empty set is always zero.\\
3. Countable Additivity:
For a countable Borel set $\{B_n\}_{n=1}^{\infty}$ then:
\[
\mu\left(\cup^{\infty}_{n=1}B_n\right)= \sum_{n=1}^{\infty}\mu(B_n)
\]
We check:
\[
\mu \left( \bigcup_{n=1}^{\infty} B_n \right) = \int_{\bigcup_{n=1}^{\infty} B_n} \rho(x) \,dx.
\]
Since integration is countably additive for disjoint sets, we can write:
\[
\int_{\bigcup_{n=1}^{\infty} B_n} \rho(x) \,dx = \sum_{n=1}^{\infty} \int_{B_n} \rho(x) \,dx.
\]
Thus,
\[
\mu \left( \bigcup_{n=1}^{\infty} B_n \right) = \sum_{n=1}^{\infty} \mu(B_n),
\]
which proves countable additivity.

\section*{6. A creative exercise:}
\begin{enumerate}
    \item[(a)] Come up with your own example of a data type which is a point pattern.
    
    \item[(b)] Would you expect it to be clustered, regular, neither, or maybe some combination of the two?
    
    \item[(c)] Would you expect it to be homogeneous or inhomogeneous?
    
    \item[(d)] Can you come up with some marks that could be associated with the point pattern?
    
    \item[(e)] Are there any covariates which might influence the point pattern?
\end{enumerate}
\(a\) Locations of weather stations or satellites providing temperature readings.\\
\(b\) A combination of clustered in areas with high population and regular in other areas to ensure even geographic coverage.\\
\(c\) A homogeneous point process would mean that measurement locations are evenly distributed across the globe, but this is not the case for temperature data. 
Instead, the distribution of measurement locations varies in space, making it inhomogeneous.\\
\(d\) Yes, e.g., location, temperature, season, humidity, time of measurement, population areas \(urban or remote\), sensor type and measurement errors.\\
\(e\) Covariates like population density, infrastructure, and land cover play a major role in shaping where stations are located.
\end{document}
